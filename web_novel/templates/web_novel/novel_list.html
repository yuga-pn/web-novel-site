{% extends "web_novel/base.html" %}
{% block content %}

{% if search_query %}
    <div class="alert alert-info mb-4" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border: none; border-radius: 12px;">
        <h5 class="mb-2">🔍 検索結果</h5>
        <p class="mb-0">「<strong>{{ search_query }}</strong>」の検索結果: {{ novels|length }} 件</p>
    </div>
{% endif %}

{% for nov in novels %}
    <div class="novel-card card">
        <div class="card-body">
            <h3 class="novel-title">
                <a class="text-decoration-none" href="{{nov.linked}}" target="_blank">
                    📖 {{nov.title}}
                </a>
            </h3>
            <div class="novel-meta">
                <strong>原作：</strong>
                {% if nov.original_work %}
                    {{nov.original_work.name}}
                {% else %}
                    {{nov.work_name|default:"未設定"}}
                {% endif %}
            </div>
            <div class="novel-meta">
                <strong>総文字数：</strong>
                {% if nov.word_count %}
                    {{nov.word_count|floatformat:0}}文字
                {% else %}
                    {{nov.word_num|default:"未設定"}}文字
                {% endif %}
            </div>
            <div class="mb-3">
                <strong>🏷️ タグ：</strong>
                {% if nov.tags.all %}
                    {% for tag in nov.tags.all %}
                        <span class="tag-badge" style="background-color: {{tag.color}}; color: white; padding: 2px 6px; border-radius: 3px; margin-right: 5px;">{{tag.name}}</span>
                    {% endfor %}
                {% else %}
                    <span class="tag-badge">{{nov.tag|default:"タグなし"}}</span>
                {% endif %}
            </div>
            <div class="d-flex justify-content-end">
                <a class="detail-btn" href="{% url 'novel_detail' nov.pk %}">
                    📚 詳細を見る
                </a>
            </div>
        </div>
    </div>
{% empty %}
    <div class="text-center py-5">
        <h4 class="text-muted">小説が見つかりませんでした</h4>
        <p class="text-muted">別のキーワードで検索してみてください</p>
    </div>
{% endfor %}

{% endblock content %}